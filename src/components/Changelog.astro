---
const categories = {
	New: "#4ade80",
	Fixed: "#f87171",
	Improved: "#60a5fa",
};

const releases = [
    {
		version: "0.7.1",
		date: "2026-02-18",
		changes: [
    		{
     			category: "New",
     			items: [
                    "MCP Server — let AI agents query your databases via the Model Context Protocol",
                    "Import data from CSV/JSON files into any table",
                    "View/Edit Row detail panel — right-click any row to inspect all fields",
                    "Run selected SQL — select a block in the query editor and run just the selection",
                    "Start/Stop MCP Server from Cmd+K command palette",
                    "Running queries and pending changes count badges on bottom panel tabs",
                    "Functions and saved queries sections in schema browser",
                ],
    		},
			{
				category: "Improved",
				items: [
				    "Pending changes moved to bottom panel for better workflow",
				    "MCP connections are pooled — parallel agent requests get isolated connections",
				    "Reliable spinner and table reload when switching databases",
				    "Schema browser accordion-style layout",
				],
			},
			{
				category: "Fixed",
				items: [
				    "DuckDB no longer hangs when GUI and AI queries run concurrently",
				    "Database connection leak on MCP server stop and disconnect",
				    "Postgres metadata queries use simple query protocol (fixes edge cases)",
				    "Deleting a table now closes its associated tabs",
				    "MCP button no longer appears after license removal",
				],
			},
		],
	},
    {
		version: "0.6.5",
		date: "2026-02-17",
		changes: [
    		{
     			category: "New",
     			items: [
                    "Popup cell editor for JSON/JSONB/text columns",
                    "Row focus highlight — click a row or navigate with arrow keys (Up/Down cycles through rows)",
                    "Keyboard row selection — Space toggles checkbox on focused row",
                ],
    		},
			{
				category: "Improved",
				items: [
				    "Improved rendering for large table",
				],
			},
			{
				category: "Fixed",
				items: [
				    "Renaming a saved query from the sidebar now updates the tab title immediately",
				    "Large JSON/JSONB cells no longer cause UI lag",
				],
			},
		],
	},
    {
		version: "0.6.0",
		date: "2026-02-15",
		changes: [
    		{
     			category: "New",
     			items: [
                    "ERD focus mode — click a node to highlight its connected neighbors as a subgraph",
                    "ERD find node — Cmd+F to search and jump to any table in the ERD",
                ],
    		},
			{
				category: "Improved",
				items: [
				    "ERD performance — viewport culling and batched schema loading",
				    "ERD zoom-out capped to prevent memory issues on large schemas",
				],
			},
		],
	},
    {
		version: "0.5.11",
		date: "2026-02-15",
		changes: [
    		{
     			category: "New",
     			items: [ "Export to CSV and SQL, delete, and truncate. Accessible from right clicking on table name schema browser." ],
      		},
			{
				category: "Fixed",
				items: [ "Wrong placement of column resize handle highlight in views" ],
			},
		],
	},
    {
		version: "0.5.10",
		date: "2026-02-15",
		changes: [
			{
				category: "Fixed",
				items: [ "Traffic light repositioning for Tahoe" ],
			},
		],
	},
	{
		version: "0.5.9",
		date: "2026-02-15",
		changes: [
			{
				category: "New",
				items: [
					"Toggle to move DB password from/to OS keychain/encrypted config file",
					"Clickable breadcrumb. For some DB like PostgreSQL, users can switch database in the same connection (if there are multiple of them, sharing same credentials)",
					"Allow setting `base_url` for AI providers",
				],
			},
			{
				category: "Improved",
				items: [
    				"Cmd+B for toggle expand allows keyboard navigation",
    				"Ctrl+tab/ctrl+shift+tab to cycle through tabs within the active pane",
    				"Smoother ERD rendering: loading and animated autolayout",
    				"Allow editing, deleting, and disconnecting connection from connection selector in the main editor without navigating to home screen",
				],
			},
			{
				category: "Fixed",
				items: [
					"Unwanted autocapitalization and possibly autocorrect",
				],
			},
		],
	},
	{
		version: "0.5.7",
		date: "2026-02-13",
		changes: [
			{
				category: "New",
				items: [ "Initial closed beta release" ],
			},
		],
	},
];
---

<section class="changelog">
	<h2>Changelog</h2>
	<p class="changelog-subtitle">What's new in DB Atelier.</p>

	<div class="changelog-entries">
		{
			releases.map((release) => (
				<div class="changelog-entry" id={`v${release.version}`}>
					<div class="changelog-header">
						<a href={`#v${release.version}`} class="changelog-version">v{release.version}</a>
						<span class="changelog-date">{release.date}</span>
					</div>
					{release.changes.map((group) => (
						<div class="changelog-group">
							<span
								class="changelog-category"
								style={`color: ${categories[group.category as keyof typeof categories]}`}
							>
								{group.category}
							</span>
							<ul class="changelog-items">
								{group.items.map((item) => (
									<li>{item}</li>
								))}
							</ul>
						</div>
					))}
				</div>
			))
		}
	</div>
</section>

<style>
	.changelog {
		text-align: center;
		max-width: 960px;
		margin: 120px auto 0;
		padding: 0 24px;
	}

	.changelog h2 {
		font-size: 24px;
		font-weight: 700;
		letter-spacing: -0.02em;
		margin-bottom: 8px;
	}

	.changelog-subtitle {
		font-size: 16px;
		color: var(--text-muted);
		margin-bottom: 40px;
	}

	.changelog-entries {
		display: flex;
		flex-direction: column;
		text-align: left;
	}

	.changelog-entry {
		padding: 20px 0;
		border-bottom: 1px solid var(--border);
	}

	.changelog-entry:first-child {
		padding-top: 0;
	}

	.changelog-entry:last-child {
		border-bottom: none;
	}

	.changelog-header {
		display: flex;
		align-items: baseline;
		gap: 10px;
		margin-bottom: 10px;
	}

	.changelog-version {
		font-size: 16px;
		font-weight: 700;
		letter-spacing: -0.02em;
		color: var(--text);
		text-decoration: none;
	}

	.changelog-version:hover {
		text-decoration: underline;
	}

	.changelog-date {
		font-size: 13px;
		color: var(--text-muted);
	}

	.changelog-group {
		margin-bottom: 8px;
	}

	.changelog-group:last-child {
		margin-bottom: 0;
	}

	.changelog-category {
		font-size: 11px;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.06em;
	}

	.changelog-items {
		list-style: none;
		padding: 0;
		margin: 4px 0 0;
	}

	.changelog-items li {
		font-size: 14px;
		color: var(--text-muted);
		padding: 2px 0;
		display: flex;
	}

	.changelog-items li::before {
		content: "—";
		color: var(--text-muted);
		flex-shrink: 0;
		margin-right: 0.5em;
	}

	@media (max-width: 768px) {
		.changelog {
			margin-top: 80px;
		}
	}
</style>
